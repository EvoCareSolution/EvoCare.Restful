@model EVOpsPro.MVCWebApp.KhiemNVD.Models.LoginRequest

@{
    ViewData["Title"] = "Login";
    Layout = "_Layout";
}

<section class="auth-shell">
    <div class="card auth-card">
        <div class="card-header mb-3">
            <div>
                <p class="text-muted mb-1 small">Welcome back</p>
                <h1 class="h4 mb-0">Log into the Control Center</h1>
            </div>
        </div>
        <form asp-action="Login" id="loginForm">
            <div asp-validation-summary="ModelOnly" class="text-danger mb-3"></div>
            <div class="mb-3">
                <label asp-for="UserName" class="form-label">User name</label>
                <input asp-for="UserName" class="form-control" value="admin@evopspro.vn" />
                <span asp-validation-for="UserName" class="text-danger"></span>
            </div>
            <div class="mb-3">
                <label asp-for="Password" class="form-label">Password</label>
                <input type="password" asp-for="Password" class="form-control" value="1" />
                <span asp-validation-for="Password" class="text-danger"></span>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary w-100">Enter workspace</button>
            </div>
            <div id="loginStatus" class="console-log mt-3" aria-live="polite"></div>
        </form>
    </div>
</section>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('loginForm');
            const statusEl = document.getElementById('loginStatus');
            if (!form || !statusEl) return;

            form.addEventListener('submit', () => {
                const steps = [
                    `> Authenticating user "${form.UserName.value}" ...`,
                    '> Encrypting credentials and contacting EvoCare API...',
                    '> Waiting for JWT and permissions...',
                    '> Finalizing session cookies...'
                ];

                statusEl.textContent = '';
                statusEl.classList.add('active');

                steps.forEach((msg, index) => {
                    setTimeout(() => {
                        statusEl.textContent += (index === 0 ? '' : '\n') + msg;
                    }, index * 450);
                });
            });
        });
    </script>
}
